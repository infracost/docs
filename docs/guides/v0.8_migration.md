---
slug: v0.8_migration
title: v0.8 migration guide
---

import useBaseUrl from '@docusaurus/useBaseUrl';

Once you've [installed Infracost v0.8](/docs/#1-install-infracost), follow this page to migrate to use the new features. Whilst we tried hard not to break old functionality by adding deprecation warnings, there is the risk of breakage as these improvements required significant code changes. Please report any [issues](https://github.com/infracost/infracost/issues/new) and we'll address them as soon as possible.

## What's new?

ðŸš€ Infracost `v0.8.0` included major improvements to the CLI:

### New diff command

A new `infracost diff` command has been added to show a diff of monthly costs between the current and planned state. This was requested by many users as we already provided similar functionality in our CI/CD integrations, but it wasn't available in the CLI, and the CI output could be confusing. We've addressed both issues by adding this new command.

<img src={useBaseUrl("img/screenshots/0.8_diff_screenshot.png")} alt="Infracost diff command" />

### Simplified table output

The dashes (-) have been replaced with price descriptions such as `Cost depends on usage: $0.20 per 1M requests` so you can understand the pricing structure of [usage-based resources](/docs/usage_based_resources) such as AWS Lambda or Google Cloud Storage.

<img src={useBaseUrl("img/screenshots/0.8_breakdown_no_usage.png")} alt="Infracost breakdown command" />

### Simplified inputs

A new `path` flag has been introduced to replace the various methods of running Infracost. You can now simply point Infracost to the path of a Terraform directory, plan binary file, or plan JSON file and it'll just work. This lays some of the groundwork for supporting other IaC tools in the future ðŸ˜‰

### Simplified config file

The config file has been updated to support infra-as-code repos that have multiple workspaces and projects. This command combines the projects into the same breakdown or diff output. So if a Terraform module or variable is used across workspaces/projects, you can quickly see the cost impact of changing it.

## Migration guide

### Commands

#### Root command

The root `infracost` command has been deprecated as we've moved to using subcommands:
- `infracost breakdown`: this works similarly to the previous `infracost` root command and shows a table breakdown of all resources by default. Run `infracost breakdown --help` to see the other options.
- `infracost diff`: this shows a list of the resources along with costs that will change when the Terraform plan is applied.

The old root command will be fully removed in v0.9.0.

#### Report command

The `infracost report` command has been deprecated and replaced with `infracost output`.

This takes Infracost JSON files as inputs via `--path` and allows them to be combined and outputted in any format using `--format json|diff|table|html`. This command can be used with wildcards too, e.g. `infracost output --format html --path infracost*.json > output.html`.

### Flags

The following flags have all been deprecated and replaced with `--path`:

- `--terraform-dir` / `--tfdir`
- `--terraform-json-file` / `--tfjson`
- `--terraform-plan-file` / `--tfplan`

The `--output`/ `-o` flag has been replaced with `--format`.

### Environment variables

The following environment variables have been deprecated:

- `TERRAFORM_BINARY`: replaced with `INFRACOST_TERRAFORM_BINARY`
- `TERRAFORM_CLOUD_HOST`: replaced with `INFRACOST_TERRAFORM_CLOUD_HOST`
- `TERRAFORM_CLOUD_TOKEN`: replaced with `INFRACOST_TERRAFORM_CLOUD_TOKEN`
- `SKIP_UPDATE_CHECK`: replaced with `INFRACOST_SKIP_UPDATE_CHECK`

### Config file

The format of the config file has been simplified and a new version parameter has been introduced to enable safer iterations in the future. Initially the config file can be used for supporting repos that have multiple workspaces or projects. See the [config file](/docs/multi_project/config_file) docs for details.

```yaml
version: 0.1
projects:
  - path: path/to/my_terraform
    terraform_workspace: dev

  - path: path/to/my_terraform
    terraform_workspace: prod
```

### JSON output

The JSON output from `infracost breakdown --format json` has been changed to the following format:

```json
{
  "version": "0.1",
  "projects": [
    {
      "path": "path/to/code",
      "metadata": {
        "terraformWorkspace": "stage",
      },
      "pastBreakdown": {
        "resources": [...]
        "totalMonthlyCost": "730",
        "totalHourlyCost": "1"
      },
      "breakdown": {
        "resources": [...]
        "totalMonthlyCost": "1460",
        "totalHourlyCost": "1"
      },
      "diff": {
        "resources": [...]
        "totalMonthlyCost": "730",
        "totalHourlyCost": "1"
      }
    }
  ],
  "summary": {
    "unsupportedResourceCounts": {...}
  },
}
```

The following top-level keys in the old JSON format are deprecated and will be removed in v0.9.0: `resources`, `totalMonthlyCost`, `totalHourlyCost`.

### CI/CD integrations

Follow the relevant sections below to upgrade your CI/CD integration.

#### GitHub Actions

#### GitLab CI

#### CircleCI

#### BitBucket Pipelines

#### Atlantis

